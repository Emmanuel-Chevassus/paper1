---
title: "filessearcher"
output: html_document
date: "2024-12-05"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(stringr)
# Define the function
search_keyword_in_rmd <- function(search_path = "/", keyword = "ncdf4") {
  # List all .Rmd files recursively
  rmd_files <- list.files(
    path = search_path,
    pattern = "\\.Rmd$",
    recursive = TRUE,
    full.names = TRUE,
    ignore.case = TRUE
  )
  
  if (length(rmd_files) == 0) {
    cat("No .Rmd files found in the specified directory.\n")
    return(NULL)
  }
  
  # Initialize results list
  results <- lapply(rmd_files, function(file) {
    tryCatch({
      # Read the file content
      content <- readLines(file, warn = FALSE)
      # Find lines containing the keyword
      matches <- grep(keyword, content, value = TRUE, ignore.case = TRUE)
      if (length(matches) > 0) {
        return(data.frame(file = file, line_number = which(grepl(keyword, content, ignore.case = TRUE)), text = matches))
      } else {
        return(NULL)
      }
    }, error = function(e) {
      cat("Error reading file:", file, "\n")
      return(NULL)
    })
  })
  
  # Combine results
  results <- do.call(rbind, results)
  
  if (!is.null(results)) {
    return(results)
  } else {
    cat("No matches found for keyword:", keyword, "\n")
    return(NULL)
  }
}

# Example usage
# Replace "/" with the root directory or specific folder you want to search
results <- search_keyword_in_rmd(search_path = "/", keyword = "ncdf4")

# View results
if (!is.null(results)) {
  print(results)
}

```

```{r}


library(officer)
library(fs)

# Specify the base directory to start searching
base_dir <- "C:/Users/Asus/Desktop"

# Function to check if a .docx file contains a specific word
contains_word <- function(file, word) {
  tryCatch({
    doc <- read_docx(file)
    text <- docx_summary(doc)$text
    any(grepl(word, text, ignore.case = TRUE, fixed = FALSE))
  }, error = function(e) {
    FALSE # Return FALSE if an error occurs
  })
}

# List all .docx files recursively
docx_files <- dir_ls(base_dir, recurse = TRUE, glob = "*.docx")

# Filter files containing the word "calibration"
files_with_calibration <- docx_files[sapply(docx_files, contains_word, word = "author contribution")]

# Print the files containing "calibration"
print(files_with_calibration)


```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```



```{r}
```





